<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Combined Feed â€” Twitter Style</title>
<style>
  :root{
    --bg:#000;
    --bg-elev:#0f1419;
    --text:#e7e9ea;
    --muted:#8b98a5;
    --accent:#1d9bf0;
    --border:#2f3336;
    --card:#0a0f14;
    --pill:#1c2733;
    --green:#00ba7c;
    --pink:#f91880;
    --yellow:#ffd400;
    --red:#f4212e;
    --radius:16px;
  }
  *{box-sizing:border-box}
  html,body{margin:0;background:var(--bg);color:var(--text);font:16px/1.45 system-ui,-apple-system,Segoe UI,Roboto,Inter,Helvetica,Arial,sans-serif}
  a{color:var(--accent);text-decoration:none}
  .wrap{max-width:680px;margin:0 auto;padding:12px}
  header{position:sticky;top:0;background:rgba(0,0,0,.7);backdrop-filter:saturate(1.2) blur(8px);border-bottom:1px solid var(--border);z-index:5}
  header .wrap{display:flex;align-items:center;gap:10px;padding:12px}
  .tab{display:inline-flex;align-items:center;gap:8px;background:var(--pill);border:1px solid var(--border);padding:6px 10px;border-radius:999px;font-weight:600}
  .feed{display:flex;flex-direction:column}
  .tweet{display:grid;grid-template-columns:56px 1fr;gap:12px;padding:12px;border-bottom:1px solid var(--border)}
  .avatar{width:48px;height:48px;border-radius:999px;background:#222;object-fit:cover}
  .row-top{display:flex;align-items:center;gap:6px;flex-wrap:wrap}
  .name{font-weight:700}
  .handle,.dot,.time{color:var(--muted);font-size:.95rem}
  .badge{display:inline-flex;align-items:center;justify-content:center;width:18px;height:18px;border-radius:999px;background:var(--accent)}
  .badge svg{width:12px;height:12px;fill:#000}
  .text{white-space:pre-wrap;margin:6px 0 10px}
  .media{border:1px solid var(--border);border-radius:14px;overflow:hidden;background:#000}
  .media img{display:block;width:100%;height:auto}
  .media video{display:block;width:100%;height:auto}
  .actions{display:flex;justify-content:space-between;gap:8px;margin-top:10px;color:var(--muted)}
  .action{display:inline-flex;align-items:center;gap:8px;padding:6px 8px;border-radius:999px}
  .action svg{width:18px;height:18px;fill:var(--muted)}
  .action:hover{background:#0b0f12}
  .counts{font-size:.95rem}
  .pill-league{display:inline-flex;align-items:center;gap:6px;background:var(--pill);border:1px solid var(--border);padding:2px 8px;border-radius:999px;font-size:.85rem;color:var(--muted);margin-bottom:8px}
  /* compact on small screens */
  @media (max-width:480px){
    .tweet{grid-template-columns:44px 1fr}
    .avatar{width:40px;height:40px}
  }
</style>
</head>
<body>
<header>
  <div class="wrap">
    <div class="tab" title="Combined timeline">Combined Feed</div>
  </div>
</header>

<main class="wrap">
  <section id="feed" class="feed" aria-live="polite"></section>
</main>

<script>
/**
 * SUPPLY DATA:
 * 1) Inline: edit FEED_DATA below, or
 * 2) Remote: set FEED_URL to your JSON endpoint and leave FEED_DATA = null.
 *
 * Post schema:
 * {
 *   id: "unique-id",
 *   source: "MLB",                // league/source label (optional)
 *   name: "MLB",
 *   handle: "@MLB",
 *   avatar: "https://...",        // image URL (optional)
 *   verified: true,               // boolean
 *   created_at: "2025-08-14T13:20:00Z", // ISO string OR number (ms)
 *   time_hint: "10h",             // optional fallback like "10h"
 *   text: "LOGAN O'HOPPE!...",
 *   media: [{type:"image", url:"..."}, {type:"video", url:"...", poster:"..."}],
 *   stats: { replies:144, reposts:521, likes:3700, views:712000 }
 * }
 */

const FEED_URL = ""; // e.g. "/feed.json"
let FEED_DATA = [
  {
    id:"ex1",
    source:"MLB",
    name:"MLB",
    handle:"@MLB",
    verified:true,
    avatar:"https://abs.twimg.com/sticky/default_profile_images/default_profile_normal.png",
    created_at: Date.now() - 10*60*60*1000,
    text:"LOGAN O'HOPPE!\n\nTHE @ANGELS TAKE THE LEAD IN THE BOTTOM OF THE 8TH!",
    media:[{type:"video", url:"", poster:""}], // placeholder demo
    stats:{replies:144,reposts:521,likes:3700,views:712000}
  },
  {
    id:"ex2",
    source:"NBA",
    name:"NBA",
    handle:"@NBA",
    verified:true,
    avatar:"https://abs.twimg.com/sticky/default_profile_images/default_profile_normal.png",
    created_at: Date.now() - 12*60*60*1000,
    text:"SABRINA IONESCU SPLASHES FROM DEEP ðŸ‘Œ",
    media:[{type:"image", url:"https://images.unsplash.com/photo-1517649763962-0c623066013b?w=1600"}],
    stats:{replies:27,reposts:44,likes:248,views:141000}
  },
  {
    id:"ex3",
    source:"NFL",
    name:"NFL",
    handle:"@NFL",
    verified:true,
    avatar:"https://abs.twimg.com/sticky/default_profile_images/default_profile_normal.png",
    created_at: Date.now() - 15*60*60*1000,
    text:"Schedule drops tomorrow. Are you ready?",
    media:[],
    stats:{replies:18,reposts:77,likes:603,views:22000}
  }
];

/* ---- Utils ---- */
const fmtCompact = n => {
  if(n===undefined||n===null) return "";
  const abs = Math.abs(n);
  if (abs < 1000) return String(n);
  if (abs < 1e6) return (n/1e3).toFixed(n%1000>=100?1:0).replace(/\.0$/,"")+"K";
  if (abs < 1e9) return (n/1e6).toFixed(n%1e6>=100000?1:0).replace(/\.0$/,"")+"M";
  return (n/1e9).toFixed(1).replace(/\.0$/,"")+"B";
};
const timeAgo = t => {
  if (!t) return "";
  const ts = typeof t === "number" ? t : Date.parse(t);
  if (isNaN(ts)) return "";
  const s = Math.max(1, (Date.now() - ts) / 1000);
  if (s < 60) return `${Math.floor(s)}s`;
  if (s < 3600) return `${Math.floor(s/60)}m`;
  if (s < 86400) return `${Math.floor(s/3600)}h`;
  return `${Math.floor(s/86400)}d`;
};

/* ---- Rendering ---- */
function icon(kind){
  const paths = {
    reply:"M14 2a8 8 0 0 1 0 16H8l-6 4 2-6A8 8 0 0 1 14 2Z",
    repost:"M3 7h8V4l6 5-6 5v-3H3V7Zm18 6h-8v3l-6-5 6-5v3h8v4Z",
    like:"M16.5 3.5c-1.9 0-3.1 1-4.5 2.6C10.6 4.5 9.4 3.5 7.5 3.5A4.5 4.5 0 0 0 3 8c0 5.2 7 9 9 12 2-3 9-6.8 9-12a4.5 4.5 0 0 0-4.5-4.5Z",
    view:"M12 5C7 5 2.7 8 1 12c1.7 4 6 7 11 7s9.3-3 11-7c-1.7-4-6-7-11-7Zm0 11a4 4 0 1 1 0-8 4 4 0 0 1 0 8Z",
    check:"M10 15l-3.5-3.5 1.4-1.4L10 12.2l5.7-5.7 1.4 1.4L10 15z"
  };
  return `<svg viewBox="0 0 24 24" aria-hidden="true"><path d="${paths[kind]}"/></svg>`;
}

function makeTweet(post){
  const ago = post.time_hint || timeAgo(post.created_at);
  const avatar = post.avatar || "data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='48' height='48'><rect width='100%' height='100%' fill='%23222'/></svg>";
  const league = post.source ? `<div class="pill-league"> ${post.source} </div>` : "";
  let mediaHtml = "";
  if (Array.isArray(post.media) && post.media.length){
    const m = post.media[0]; // simple: one primary media
    if (m.type === "video" && m.url){
      mediaHtml = `<div class="media"><video ${m.poster?`poster="${m.poster}"`:''} controls playsinline muted preload="metadata" src="${m.url}"></video></div>`;
    } else if (m.type === "image" && m.url){
      mediaHtml = `<div class="media"><img loading="lazy" src="${m.url}" alt="" /></div>`;
    }
  }
  const stats = post.stats || {};
  return `
  <article class="tweet" data-id="${post.id}">
    <img class="avatar" alt="" src="${avatar}">
    <div>
      ${league}
      <div class="row-top">
        <span class="name">${post.name||""}</span>
        ${post.verified?`<span class="badge" title="Verified">${icon("check")}</span>`:""}
        <span class="handle">${post.handle||""}</span>
        <span class="dot">Â·</span>
        <span class="time" title="${new Date(post.created_at||Date.now()).toLocaleString()}">${ago}</span>
      </div>
      <div class="text">${(post.text||"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\n/g,"<br>")}</div>
      ${mediaHtml}
      <div class="actions" role="group" aria-label="Tweet actions">
        <div class="action" title="Reply">${icon("reply")} <span class="counts">${fmtCompact(stats.replies||0)}</span></div>
        <div class="action" title="Repost">${icon("repost")} <span class="counts">${fmtCompact(stats.reposts||0)}</span></div>
        <div class="action" title="Like">${icon("like")} <span class="counts">${fmtCompact(stats.likes||0)}</span></div>
        <div class="action" title="Views">${icon("view")} <span class="counts">${fmtCompact(stats.views||0)}</span></div>
      </div>
    </div>
  </article>`;
}

function renderFeed(list){
  // Sort newest first by created_at if present
  list.sort((a,b)=>{
    const ta = typeof a.created_at === "number" ? a.created_at : Date.parse(a.created_at||0);
    const tb = typeof b.created_at === "number" ? b.created_at : Date.parse(b.created_at||0);
    return (tb||0) - (ta||0);
  });
  const html = list.map(makeTweet).join("");
  document.getElementById("feed").innerHTML = html;
}

/* ---- Boot ---- */
(async function init(){
  try{
    let data = FEED_DATA;
    if (!data && FEED_URL){
      const res = await fetch(FEED_URL,{cache:"no-store"});
      data = await res.json();
    }
    if (!Array.isArray(data)) data = [];
    renderFeed(data);
  }catch(e){
    console.error(e);
    document.getElementById("feed").innerHTML =
      `<div style="padding:16px;color:var(--muted)">Failed to load feed.</div>`;
  }
})();
</script>
</body>
</html>
