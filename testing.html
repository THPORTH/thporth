<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>Blank Page</title>

    </head>
<body>

    <div id="live-headlines-container">
  <h3>Live Headlines</h3>
  <div id="live-headlines-feed">
    </div>
</div>

<script>
	document.addEventListener('DOMContentLoaded', function () {
    // Make sure Firebase is initialized before this runs
    if (firebase && firebase.firestore) {
        const db = firebase.firestore();
        const headlinesContainer = document.getElementById('live-headlines-feed');

        // Reference to the new collection we created in Zapier
        const headlinesRef = db.collection('liveHeadlines');

        // Listen for real-time updates
        headlinesRef
            .orderBy('published', 'desc') // Show the newest headlines first
            .limit(20) // Get the latest 20 headlines
            .onSnapshot(snapshot => {
                if (snapshot.empty) {
                    headlinesContainer.innerHTML = '<p>No headlines found.</p>';
                    return;
                }

                let headlinesHtml = '<ul>';
                snapshot.forEach(doc => {
                    const headline = doc.data();
                    // Create a list item and a link for each headline
                    headlinesHtml += `
                        <li>
                            <a href="${headline.url}" target="_blank">
                                ${headline.title}
                            </a>
                        </li>
                    `;
                });
                headlinesHtml += '</ul>';

                headlinesContainer.innerHTML = headlinesHtml;

            }, error => {
                console.error("Error fetching live headlines: ", error);
                headlinesContainer.innerHTML = '<p>Error loading headlines.</p>';
            });
    }
});
</script>
    </body>
</html>
